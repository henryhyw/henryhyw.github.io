<div class="menu">
  <nav class="menu-content">
    {% for item in site.data.settings.menu %}
      <a href="{{ site.github.url }}/{{ item.url }}">{{ item.name }}</a>
    {% endfor %}
  </nav>
<!--   <nav class="social-icons">
    {% include social-icons.html %}
  </nav> -->
  <nav class="social-icons">
    <a id="music-icon" title="Play Music"><i class="fa fa-compact-disc" aria-hidden="true"></i></a>
  </nav>
</div>

<audio id="background-music" src="/assets/aud/bg.mp3"></audio>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    const musicIcon = document.getElementById("music-icon");
    const music = document.getElementById("background-music");

    // Restore music state from localStorage
    if (localStorage.getItem("musicTime")) {
      music.currentTime = localStorage.getItem("musicTime");
    }
    if (localStorage.getItem("musicPlaying") === "true") {
      music.play();
      musicIcon.querySelector("i").classList.add("fa-spin");
      musicIcon.title = "Pause Music";
    }

    musicIcon.addEventListener("click", function() {
      if (music.paused) {
        music.play();
        musicIcon.querySelector("i").classList.add("fa-spin");
        musicIcon.title = "Pause Music";
        localStorage.setItem("musicPlaying", "true");
      } else {
        music.pause();
        musicIcon.querySelector("i").classList.remove("fa-spin");
        musicIcon.title = "Play Music";
        localStorage.setItem("musicPlaying", "false");
      }
    });

    // Save music state before leaving the page
    window.addEventListener("beforeunload", function() {
      localStorage.setItem("musicTime", music.currentTime);
      localStorage.setItem("musicPlaying", !music.paused);
    });
  });
</script>